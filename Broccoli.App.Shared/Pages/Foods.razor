@page "/foods"
@using Broccoli.Data.Models
@using Broccoli.Shared.Services
@inject IFoodService FoodService

<AuthorizeView>
    <PageTitle>Foods</PageTitle>

    <h1>Food Database</h1>

    <p>Browse all available foods in the database.</p>

    @if (_foods == null)
    {
        <p><em>Loading...</em></p>
    }
    else if (!_foods.Any())
    {
        <p><em>No foods found.</em></p>
    }
    else
    {
        <div class="table-responsive" style="max-height: 70vh; overflow-y: auto;">
            <table class="table table-striped table-hover">
                <thead class="sticky-top bg-light">
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Measure</th>
                    <th>Grams Per Measure</th>
                    <th>Calories (per 100g)</th>
                    <th>Fat (per 100g)</th>
                    <th>Carbohydrates (per 100g)</th>
                    <th>Protein (per 100g)</th>
                    <th>Notes</th>
                </tr>
                </thead>
                <tbody>
                @foreach (var food in _foods)
                {
                    <tr>
                        <td>@food.Id</td>
                        <td>@food.Name</td>
                        <td>@food.Measure</td>
                        <td>@food.GramsPerMeasure.ToString("F2")</td>
                        <td>@food.CaloriesPer100g.ToString("F2")</td>
                        <td>@food.FatPer100g.ToString("F2")</td>
                        <td>@food.CarbohydratesPer100g.ToString("F2")</td>
                        <td>@food.ProteinPer100g.ToString("F2")</td>
                        <td>@food.Notes</td>
                    </tr>
                }
                </tbody>
            </table>
        </div>
        <p class="mt-3"><strong>Total foods: @_foods.Count()</strong></p>
    }
</AuthorizeView>




@code {
    private IEnumerable<Food>? _foods;

    protected override async Task OnInitializedAsync()
    {
        _foods = await FoodService.GetAllAsync();
    }

}